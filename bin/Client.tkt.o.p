{"definition":{"name":"Client","version":"1.0","location":"https://github.com/thicket-lang/thicket-library-w3client","description":"W3 Client package","developers":[{"name":"D. Plaindoux","mail":"d.plaindoux@free.fr"}],"modules":["Boot.Client","Client.Document","Client.Document.Renderer","Client.Event","Client.Event.Mouse","Client.Event.Key"],"native":{"javascript":["dom.js"]},"requires":[{"Core":"1.0"}]},"content":{"Boot.Client.tkt.o":{"namespace":"Boot.Client","objcode":[],"main":[]},"Client.Document.tkt.o":{"namespace":"Client.Document","objcode":[[9,["dom",[["addEmptyAttribute",[[6,[[3,2],[5,"addAttribute"],[3,3],[4],[7,[[2,"Data.String.string"],[1,""],[4]]],[12]]],[14]]],["addOptionalAttribute",[[6,[[6,[[3,4],[5,"fold"],[3,2],[4],[7,[[3,2],[5,"addAttribute"],[3,3],[4]]],[12]]],[14]]],[14]]],["addAttribute",[[2,"System.Internal.internal"],[7,[[2,"Data.String.string"],[1,"dom.setAttribute"],[4]]],[4],[3,2],[12]]],["findAttribute",[[6,[[2,"System.Internal.internal"],[7,[[2,"Data.String.string"],[1,"dom.getAttribute"],[4]]],[4],[3,2],[4],[3,3],[4],[6,[[2,"Data.Option.some"],[7,[[2,"Data.String.string"],[3,4],[4]]],[12]]],[4],[7,[[2,"Data.Option.none"]]],[12]]],[14]]],["removeAttribute",[[2,"System.Internal.internal"],[7,[[2,"Data.String.string"],[1,"dom.resetAttribute"],[4]]],[4],[3,2],[12]]],["addChild",[[2,"System.Internal.internal"],[7,[[2,"Data.String.string"],[1,"dom.appendChild"],[4]]],[4],[3,2],[12]]],["addChilds",[[6,[[3,3],[5,"foldL"],[6,[[3,4],[13,"addChild"]]],[4],[3,2],[12]]],[14]]],["removeChilds",[[2,"System.Internal.internal"],[7,[[2,"Data.String.string"],[1,"dom.removeChilds"],[4]]],[4],[3,2],[12]]],["onCondition",[[6,[[6,[[3,3],[5,"fold"],[7,[[3,4],[3,2],[4]]],[4],[3,2],[12]]],[14]]],[14]]],["onMouseEvent",[[6,[[6,[[2,"System.Internal.internal"],[7,[[2,"Data.String.string"],[1,"dom.onMouseEvent"],[4]]],[4],[3,2],[4],[2,"Client.Event.Mouse.mouseEventType"],[3,3],[4],[5,"toString"],[4],[6,[[3,4],[7,[[2,"Client.Document.dom"],[3,5],[4]]],[12]]],[12]]],[14]]],[14]]],["onKeyEvent",[[6,[[6,[[2,"System.Internal.internal"],[7,[[2,"Data.String.string"],[1,"dom.onKeyEvent"],[4]]],[4],[3,2],[4],[2,"Client.Event.Key.keyEventType"],[3,3],[4],[5,"toString"],[4],[6,[[6,[[3,4],[7,[[2,"Client.Document.dom"],[3,5],[4]]],[4],[7,[[2,"Data.Number.number"],[3,6],[4]]],[12]]],[14]]],[12]]],[14]]],[14]]],["find",[[6,[[2,"System.Internal.internal"],[7,[[2,"Data.String.string"],[1,"dom.elementById"],[4]]],[4],[3,2],[4],[3,3],[4],[6,[[2,"Data.Option.some"],[7,[[2,"Client.Document.dom"],[3,4],[4]]],[12]]],[4],[7,[[2,"Data.Option.none"]]],[12]]],[14]]],["clone",[[2,"Client.Document.dom"],[7,[[2,"System.Internal.internal"],[7,[[2,"Data.String.string"],[1,"dom.clone"],[4]]],[4],[3,2],[4]]],[12]]],["replaceWith",[[2,"System.Internal.internal"],[7,[[2,"Data.String.string"],[1,"dom.replace"],[4]]],[4],[3,2],[12]]],["remove",[[2,"System.Internal.internal"],[7,[[2,"Data.String.string"],[1,"dom.remove"],[4]]],[4],[3,2],[12]]],["value",[[2,"System.Internal.internal"],[7,[[2,"Data.String.string"],[1,"dom.getValue"],[4]]],[4],[3,2],[4],[6,[[2,"Data.Option.some"],[7,[[2,"Data.String.string"],[3,3],[4]]],[12]]],[4],[7,[[2,"Data.Option.none"]]],[12]]],["map",[[6,[[3,3],[3,2],[12]]],[14]]]],[]]],[9,["document",[["create",[[2,"Client.Document.dom"],[7,[[2,"System.Internal.internal"],[7,[[2,"Data.String.string"],[1,"document.createElement"],[4]]],[4],[3,1],[4]]],[12]]],["find",[[2,"System.Internal.internal"],[7,[[2,"Data.String.string"],[1,"document.elementById"],[4]]],[4],[3,1],[4],[6,[[2,"Data.Option.some"],[7,[[2,"Client.Document.dom"],[3,3],[4]]],[12]]],[4],[7,[[2,"Data.Option.none"]]],[12]]]],[]]],[10,["dom2domlist",[[6,[[2,"Data.List.List"],[5,"["],[3,1],[4],[13,"]"]]]]]],[10,["string2dom",[[6,[[2,"Client.Document.dom"],[7,[[2,"System.Internal.internal"],[7,[[2,"Data.String.string"],[1,"string.toDom"],[4]]],[4],[3,1],[4]]],[12]]]]]],[10,["string2domlist",[[6,[[2,"Data.List.List"],[5,"["],[7,[[2,"Client.Document.dom"],[7,[[2,"System.Internal.internal"],[7,[[2,"Data.String.string"],[1,"string.toDom"],[4]]],[4],[3,1],[4]]],[4]]],[4],[13,"]"]]]]]],[10,["number2dom",[[6,[[2,"Client.Document.dom"],[7,[[2,"System.Internal.internal"],[7,[[2,"Data.String.string"],[1,"string.toDom"],[4]]],[4],[7,[[2,"Data.Number.number2string"],[3,1],[4]]],[4]]],[12]]]]]],[10,["number2domlist",[[6,[[2,"Data.List.List"],[5,"["],[7,[[2,"Client.Document.dom"],[7,[[2,"System.Internal.internal"],[7,[[2,"Data.String.string"],[1,"string.toDom"],[4]]],[4],[7,[[2,"Data.Number.number2string"],[3,1],[4]]],[4]]],[4]]],[4],[13,"]"]]]]]]],"main":[]},"Client.Document.Renderer.tkt.o":{"namespace":"Client.Document.Renderer","objcode":[[8,["Renderer",[["<?",[[3,1],[14]]],["<~",[[3,2],[14]]]]]],[10,["domRenderer",[[6,[[2,"Client.Document.Renderer.Renderer"],[6,[[3,2],[5,"fold"],[7,[[2,"Client.Document.Renderer.documentRenderer"]]],[4],[2,"Client.Document.Renderer.documentRenderer"],[5,"<~"],[12]]],[4],[6,[[2,"Lang.Do.do"],[7,[[3,2],[5,"findAttribute"],[7,[[2,"Data.String.string"],[1,"id"],[4]]],[4],[5,"flatmap"],[6,[[3,1],[5,"find"],[3,3],[4],[5,"map"],[6,[[3,4],[5,"replaceWith"],[3,2],[12]]],[12]]],[4]]],[4],[5,"return"],[7,[[2,"Client.Document.Renderer.documentRenderer"]]],[12]]],[12]]]]]],[10,["documentRenderer",[[2,"Client.Document.Renderer.Renderer"],[6,[[3,1],[5,"fold"],[7,[[2,"Client.Document.Renderer.documentRenderer"]]],[4],[2,"Client.Document.Renderer.documentRenderer"],[5,"<~"],[12]]],[4],[6,[[2,"Lang.Do.do"],[7,[[3,1],[5,"findAttribute"],[7,[[2,"Data.String.string"],[1,"id"],[4]]],[4],[5,"flatmap"],[6,[[2,"Client.Document.document"],[3,2],[4],[5,"find"],[5,"map"],[6,[[3,3],[5,"replaceWith"],[3,1],[12]]],[12]]],[4]]],[4],[5,"return"],[7,[[2,"Client.Document.Renderer.documentRenderer"]]],[12]]],[4]]]]],"main":[]},"Client.Event.tkt.o":{"namespace":"Client.Event","objcode":[[8,["EventTrigger",[["install",[[3,1],[14]]]]]]],"main":[]},"Client.Event.Mouse.tkt.o":{"namespace":"Client.Event.Mouse","objcode":[[8,["MouseOver",[]]],[8,["MouseOut",[]]],[8,["MouseDown",[]]],[8,["MouseUp",[]]],[8,["MouseClick",[]]],[8,["MouseDblClick",[]]],[8,["ContextMenu",[]]],[8,["MouseEventType",[]]],[9,["mouseEventType",[["MouseOver.toString",[[2,"Data.String.string"],[1,"mouseover"],[12]]],["MouseOut.toString",[[2,"Data.String.string"],[1,"mouseout"],[12]]],["MouseDown.toString",[[2,"Data.String.string"],[1,"mousedown"],[12]]],["MouseUp.toString",[[2,"Data.String.string"],[1,"mousesup"],[12]]],["MouseClick.toString",[[2,"Data.String.string"],[1,"click"],[12]]],["MouseDblClick.toString",[[2,"Data.String.string"],[1,"dblclick"],[12]]],["ContextMenu.toString",[[2,"Data.String.string"],[1,"contextmenu"],[12]]]],[]]]],"main":[]},"Client.Event.Key.tkt.o":{"namespace":"Client.Event.Key","objcode":[[8,["KeyPress",[]]],[8,["KeyDown",[]]],[8,["KeyUp",[]]],[8,["KeyEventType",[]]],[9,["keyEventType",[["KeyPress.toString",[[2,"Data.String.string"],[1,"keypress"],[12]]],["KeyDown.toString",[[2,"Data.String.string"],[1,"keydown"],[12]]],["KeyUp.toString",[[2,"Data.String.string"],[1,"keypup"],[12]]]],[]]],[8,["Keys",[["CARRIAGE_RETURN",[[3,1],[14]]]]]],[10,["standardKeys",[[2,"Client.Event.Key.Keys"],[7,[[2,"Data.Number.number"],[1,13],[4]]],[4]]]]],"main":[]},"dom.js":"LyogZ2xvYmFsIGRvY3VtZW50Ki8KCi8qCiAqIFRoaWNrZXQKICogaHR0cHM6Ly9naXRodWIuY29tL2QtcGxhaW5kb3V4L3RoaWNrZXQKICoKICogQ29weXJpZ2h0IChjKSAyMDE1IERpZGllciBQbGFpbmRvdXgKICogTGljZW5zZWQgdW5kZXIgdGhlIExHUEwyIGxpY2Vuc2UuCiAqLwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihydW50aW1lKSB7CiAgICAKICAgICd1c2Ugc3RyaWN0JzsKCiAgICB2YXIgJGkgPSBydW50aW1lLmluc3RydWN0aW9uOyAKCiAgICBydW50aW1lLm5hdGl2ZSgic3RyaW5nLnRvRG9tIiwgMSwgZnVuY3Rpb24oZW52KSB7CiAgICAgICAgdmFyIG5hbWUgPSBydW50aW1lLmNvbnN0YW50KGVudi5wb3AoKSk7CiAgICAgICAgCiAgICAgICAgcmV0dXJuIFtbICRpLkNPTlNULCBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShuYW1lKSBdXTsKICAgIH0pOwoKICAgIHJ1bnRpbWUubmF0aXZlKCJkb2N1bWVudC5lbGVtZW50QnlJZCIsIDMsIGZ1bmN0aW9uKGVudil7CiAgICAgICAgdmFyIG5hbWUgPSBydW50aW1lLmNvbnN0YW50KGVudi5wb3AoKSksCiAgICAgICAgICAgIGFTb21lID0gZW52LnBvcCgpLAogICAgICAgICAgICBhTm9uZSA9IGVudi5wb3AoKSwgIAogICAgICAgICAgICAvLyBDb21wdXRlZCB2YWx1ZQogICAgICAgICAgICBub2RlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobmFtZSk7CiAgICAgICAgCiAgICAgICAgaWYgKG5vZGUpIHsKICAgICAgICAgICAgcmV0dXJuIFtbICRpLlJFU1VMVCwgYVNvbWUgXSwgWyAkaS5DT05TVCwgbm9kZSBdLCBbICRpLkFQUExZIF1dOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBbWyAkaS5SRVNVTFQsIGFOb25lIF1dOwogICAgICAgIH0KICAgIH0pOwogICAgCiAgICBydW50aW1lLm5hdGl2ZSgiZG9jdW1lbnQuY3JlYXRlRWxlbWVudCIsIDEsIGZ1bmN0aW9uKGVudil7CiAgICAgICAgdmFyIG5hbWUgPSBydW50aW1lLmNvbnN0YW50KGVudi5wb3AoKSk7CgogICAgICAgIHJldHVybiBbWyAkaS5DT05TVCwgZG9jdW1lbnQuY3JlYXRlRWxlbWVudChuYW1lKSBdXTsKICAgIH0pOwoKICAgIHJ1bnRpbWUubmF0aXZlKCJkb20uZWxlbWVudEJ5SWQiLCAzLCBmdW5jdGlvbihlbnYpewogICAgICAgIHZhciBzZWxmID0gcnVudGltZS5jb25zdGFudChlbnYucG9wKCkpLAogICAgICAgICAgICBuYW1lID0gcnVudGltZS5jb25zdGFudChlbnYucG9wKCkpLCAgICAgICAgICAgIAogICAgICAgICAgICBhU29tZSA9IGVudi5wb3AoKSwKICAgICAgICAgICAgYU5vbmUgPSBlbnYucG9wKCksICAKICAgICAgICAgICAgLy8gQ29tcHV0ZWQgdmFsdWUKICAgICAgICAgICAgbm9kZSA9IHNlbGYuZ2V0RWxlbWVudEJ5SWQobmFtZSk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgIGlmIChub2RlKSB7CiAgICAgICAgICAgIHJldHVybiBbWyAkaS5SRVNVTFQsIGFTb21lIF0sIFsgJGkuQ09OU1QsIG5vZGUgXSwgWyAkaS5BUFBMWSBdXTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gW1sgJGkuUkVTVUxULCBhTm9uZSBdXTsKICAgICAgICB9CiAgICB9KTsKICAgIAogICAgcnVudGltZS5uYXRpdmUoImRvbS5zZXRBdHRyaWJ1dGUiLCAzLCBmdW5jdGlvbihlbnYpewogICAgICAgIHZhciBzZWxmID0gZW52LnBvcCgpLAogICAgICAgICAgICBuYW1lID0gcnVudGltZS5jb25zdGFudChlbnYucG9wKCkpLAogICAgICAgICAgICB2YWx1ZSA9IHJ1bnRpbWUuY29uc3RhbnQoZW52LnBvcCgpKSwKICAgICAgICAgICAgLy8gQ29tcHV0ZWQgdmFsdWUKICAgICAgICAgICAgbm9kZSA9IHJ1bnRpbWUuY29uc3RhbnQoc2VsZik7CgogICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKG5hbWUsIHZhbHVlKTsKICAgICAgICAKICAgICAgICByZXR1cm4gW1sgJGkuUkVTVUxULCBzZWxmIF1dOwogICAgfSk7CgogICAgcnVudGltZS5uYXRpdmUoImRvbS5nZXRBdHRyaWJ1dGUiLCA0LCBmdW5jdGlvbihlbnYpewogICAgICAgIHZhciBzZWxmID0gZW52LnBvcCgpLAogICAgICAgICAgICBuYW1lID0gcnVudGltZS5jb25zdGFudChlbnYucG9wKCkpLAogICAgICAgICAgICBhU29tZSA9IGVudi5wb3AoKSwKICAgICAgICAgICAgYU5vbmUgPSBlbnYucG9wKCksICAgICAgICAgIAogICAgICAgICAgICAvLyBDb21wdXRlZCB2YWx1ZQogICAgICAgICAgICBub2RlID0gcnVudGltZS5jb25zdGFudChzZWxmKSwKICAgICAgICAgICAgdmFsdWUgPSBub2RlLmdldEF0dHJpYnV0ZShuYW1lKTsKICAgICAgICAKICAgICAgICBpZiAobm9kZSkgewogICAgICAgICAgICByZXR1cm4gW1sgJGkuUkVTVUxULCBhU29tZSBdLCBbICRpLkNPTlNULCB2YWx1ZV0sIFsgJGkuQVBQTFkgXV07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIFtbICRpLlJFU1VMVCwgYU5vbmUgXV07CiAgICAgICAgfQogICAgfSk7CgogICAgcnVudGltZS5uYXRpdmUoImRvbS5yZXNldEF0dHJpYnV0ZSIsIDIsIGZ1bmN0aW9uKGVudil7CiAgICAgICAgdmFyIHNlbGYgPSBlbnYucG9wKCksCiAgICAgICAgICAgIG5hbWUgPSBydW50aW1lLmNvbnN0YW50KGVudi5wb3AoKSksCiAgICAgICAgICAgIC8vIENvbXB1dGVkIHZhbHVlCiAgICAgICAgICAgIG5vZGUgPSBydW50aW1lLmNvbnN0YW50KHNlbGYpOwoKICAgICAgICBub2RlLnJlbW92ZUF0dHJpYnV0ZShuYW1lKTsKICAgICAgICAKICAgICAgICByZXR1cm4gW1sgJGkuUkVTVUxULCBzZWxmIF1dOwogICAgfSk7CgogICAgcnVudGltZS5uYXRpdmUoImRvbS5nZXRWYWx1ZSIsIDMsIGZ1bmN0aW9uKGVudil7CiAgICAgICAgdmFyIG5vZGUgPSBydW50aW1lLmNvbnN0YW50KGVudi5wb3AoKSksCiAgICAgICAgICAgIGFTb21lID0gZW52LnBvcCgpLAogICAgICAgICAgICBhTm9uZSA9IGVudi5wb3AoKTsKCiAgICAgICAgaWYgKG5vZGUudmFsdWUpIHsKICAgICAgICAgICAgcmV0dXJuIFtbICRpLlJFU1VMVCwgYVNvbWUgXSwgWyAkaS5DT05TVCwgbm9kZS52YWx1ZSBdLCBbICRpLkFQUExZIF1dOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBbWyAkaS5SRVNVTFQsIGFOb25lIF1dOwogICAgICAgIH0KICAgIH0pOwoKICAgIHJ1bnRpbWUubmF0aXZlKCJkb20ub25Nb3VzZUV2ZW50IiwgMywgZnVuY3Rpb24oZW52KXsKICAgICAgICB2YXIgc2VsZiA9IGVudi5wb3AoKSwKICAgICAgICAgICAgZXZlbnQgPSBydW50aW1lLmNvbnN0YW50KGVudi5wb3AoKSksCiAgICAgICAgICAgIHZhbHVlID0gZW52LnBvcCgpLAogICAgICAgICAgICAvLyBDb21wdXRlZCB2YWx1ZQogICAgICAgICAgICBub2RlID0gcnVudGltZS5jb25zdGFudChzZWxmKTsKICAgICAgICAKICAgICAgICBub2RlLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIHJ1bnRpbWUuZXhlY3V0ZShbWyAkaS5SRVNVTFQsIHZhbHVlIF0sIFsgJGkuQ09OU1QsIG5vZGUgXSwgWyAkaS5BUFBMWSBdXSk7CiAgICAgICAgfSk7CiAgICAgICAgCiAgICAgICAgcmV0dXJuIFtbICRpLlJFU1VMVCwgc2VsZiBdXTsKICAgIH0pOyAgICAKICAgIAogICAgcnVudGltZS5uYXRpdmUoImRvbS5vbktleUV2ZW50IiwgMywgZnVuY3Rpb24oZW52KXsKICAgICAgICB2YXIgc2VsZiA9IGVudi5wb3AoKSwKICAgICAgICAgICAgZXZlbnQgPSBydW50aW1lLmNvbnN0YW50KGVudi5wb3AoKSksCiAgICAgICAgICAgIHZhbHVlID0gZW52LnBvcCgpLAogICAgICAgICAgICAvLyBDb21wdXRlZCB2YWx1ZQogICAgICAgICAgICBub2RlID0gcnVudGltZS5jb25zdGFudChzZWxmKTsKICAgICAgICAKICAgICAgICBub2RlLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGZ1bmN0aW9uIChldnQpIHsgICAgICAgICAgICAKICAgICAgICAgICAgdmFyIGtleUNvZGUgPSBldnQua2V5Q29kZTsKICAgICAgICAgICAgcmV0dXJuIHJ1bnRpbWUuZXhlY3V0ZShbWyAkaS5SRVNVTFQsIHZhbHVlIF0sIFsgJGkuQ09OU1QsIG5vZGUgXSwgWyAkaS5BUFBMWSBdLCBbICRpLkNPTlNULCBrZXlDb2RlIF0sIFsgJGkuQVBQTFkgXV0pOwogICAgICAgIH0pOwogICAgICAgIAogICAgICAgIHJldHVybiBbWyAkaS5SRVNVTFQsIHNlbGYgXV07CiAgICB9KTsgICAgCiAgICAKICAgIHJ1bnRpbWUubmF0aXZlKCJkb20uYXBwZW5kQ2hpbGQiLCAyLCBmdW5jdGlvbihlbnYpewogICAgICAgIGZ1bmN0aW9uIGFkZENoaWxkKG5vZGUsIGNoaWxkKSB7CiAgICAgICAgICAgIHZhciB2YWx1ZSA9IHJ1bnRpbWUuY29uc3RhbnQoY2hpbGQpOwogICAgICAgICAgICAKICAgICAgICAgICAgaWYgKHJ1bnRpbWUuZ2V0VHlwZSh2YWx1ZSkgPT09ICdBcnJheScpIHsKICAgICAgICAgICAgICAgIHZhbHVlLmZvckVhY2goZnVuY3Rpb24oY2hpbGQpIHsKICAgICAgICAgICAgICAgICAgICBhZGRDaGlsZChub2RlLCBjaGlsZCk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIG5vZGUuYXBwZW5kQ2hpbGQodmFsdWUpOwogICAgICAgICAgICB9ICAgICAgICAgICAgCiAgICAgICAgfQogICAgICAgIAogICAgICAgIHZhciBzZWxmID0gZW52LnBvcCgpLAogICAgICAgICAgICBjaGlsZCA9IGVudi5wb3AoKSwKICAgICAgICAgICAgLy8gQ29tcHV0ZWQgdmFsdWUKICAgICAgICAgICAgbm9kZSA9IHJ1bnRpbWUuY29uc3RhbnQoc2VsZik7CgogICAgICAgIGFkZENoaWxkKG5vZGUsIGNoaWxkKTsKCiAgICAgICAgcmV0dXJuIFtbICRpLlJFU1VMVCwgc2VsZiBdXTsKICAgIH0pOyAgICAKICAgICAgCiAgICBydW50aW1lLm5hdGl2ZSgiZG9tLnJlbW92ZUNoaWxkcyIsIDEsIGZ1bmN0aW9uKGVudil7CiAgICAgICAgdmFyIHNlbGYgPSBlbnYucG9wKCksCiAgICAgICAgICAgIC8vIENvbXB1dGVkIHZhbHVlCiAgICAgICAgICAgIG5vZGUgPSBydW50aW1lLmNvbnN0YW50KHNlbGYpOwogICAgICAgIAogICAgICAgIHdoaWxlIChub2RlLmZpcnN0Q2hpbGQpIHsKICAgICAgICAgICAgbm9kZS5yZW1vdmVDaGlsZChub2RlLmZpcnN0Q2hpbGQpOwogICAgICAgIH0gIAoKICAgICAgICByZXR1cm4gW1sgJGkuUkVTVUxULCBzZWxmIF1dOwogICAgfSk7CiAgICAgICAgICAgIAogICAgcnVudGltZS5uYXRpdmUoImRvbS5jbG9uZSIsIDEsIGZ1bmN0aW9uKGVudil7CiAgICAgICAgdmFyIG5vZGUgPSBydW50aW1lLmNvbnN0YW50KGVudi5wb3AoKSk7CgogICAgICAgIHJldHVybiBbWyAgJGkuQ09OU1QsIG5vZGUuY2xvbmVOb2RlKHRydWUpIF1dOwogICAgfSk7CgogICAgcnVudGltZS5uYXRpdmUoImRvbS5yZW1vdmUiLCAxLCBmdW5jdGlvbihlbnYpewogICAgICAgIHZhciBzZWxmID0gZW52LnBvcCgpLAogICAgICAgICAgICAvLyBDb21wdXRlZCB2YWx1ZQogICAgICAgICAgICBub2RlID0gcnVudGltZS5jb25zdGFudChzZWxmKTsKCiAgICAgICAgbm9kZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG5vZGUpOwogICAgICAgIAogICAgICAgIHJldHVybiBbWyAkaS5SRVNVTFQsIHNlbGYgXV07CiAgICB9KTsKCiAgICBydW50aW1lLm5hdGl2ZSgiZG9tLnJlcGxhY2UiLCAyLCBmdW5jdGlvbihlbnYpewogICAgICAgIHZhciBub2RlID0gcnVudGltZS5jb25zdGFudChlbnYucG9wKCkpLAogICAgICAgICAgICBuZXdTZWxmID0gZW52LnBvcCgpLAogICAgICAgICAgICAvLyBDb21wdXRlZCB2YWx1ZQogICAgICAgICAgICBuZXdOb2RlID0gcnVudGltZS5jb25zdGFudChuZXdTZWxmKTsKICAgICAgICAKICAgICAgICBpZiAobm9kZS5wYXJlbnROb2RlKSB7CiAgICAgICAgICAgIG5vZGUucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQobmV3Tm9kZSxub2RlKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcmV0dXJuIFtbICRpLlJFU1VMVCwgbmV3U2VsZiBdXTsKICAgIH0pOwogICAgCn07CiA="}}